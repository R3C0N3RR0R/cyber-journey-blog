<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f23"/>
      <stop offset="100%" style="stop-color:#1a1a2e"/>
    </linearGradient>
    
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00ff88"/>
      <stop offset="100%" style="stop-color:#00cc44"/>
    </linearGradient>
    
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#74b9ff"/>
      <stop offset="100%" style="stop-color:#0984e3"/>
    </linearGradient>
    
    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b35"/>
      <stop offset="100%" style="stop-color:#d63031"/>
    </linearGradient>
    
    <!-- Flèches -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="url(#greenGrad)"/>
    </marker>
  </defs>
  
  <!-- Fond -->
  <rect width="800" height="600" fill="url(#bgGrad)"/>
  
  <!-- Titre -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="28" font-weight="bold" 
        text-anchor="middle" fill="url(#greenGrad)">CryptOfTheUndead - Challenge Flow</text>
  
  <!-- Phase 1: Reconnaissance -->
  <g id="phase1">
    <rect x="50" y="80" width="160" height="120" rx="10" fill="#2d3436" stroke="url(#blueGrad)" stroke-width="2"/>
    <text x="130" y="105" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="url(#blueGrad)">Phase 1</text>
    <text x="130" y="125" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="white">Reconnaissance</text>
    
    <text x="60" y="145" font-family="monospace" font-size="11" fill="#ddd">• file crypt</text>
    <text x="60" y="160" font-family="monospace" font-size="11" fill="#ddd">• strings crypt</text>
    <text x="60" y="175" font-family="monospace" font-size="11" fill="#ddd">• ./crypt (test)</text>
    <text x="60" y="190" font-family="monospace" font-size="11" fill="#00ff88">→ ELF 64-bit</text>
  </g>
  
  <!-- Phase 2: Analyse Statique -->
  <g id="phase2">
    <rect x="320" y="80" width="160" height="120" rx="10" fill="#2d3436" stroke="url(#orangeGrad)" stroke-width="2"/>
    <text x="400" y="105" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="url(#orangeGrad)">Phase 2</text>
    <text x="400" y="125" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="white">Analyse Statique</text>
    
    <text x="330" y="145" font-family="monospace" font-size="11" fill="#ddd">• objdump -d</text>
    <text x="330" y="160" font-family="monospace" font-size="11" fill="#ddd">• objdump -s .rodata</text>
    <text x="330" y="175" font-family="monospace" font-size="11" fill="#ddd">• Analyse des fonctions</text>
    <text x="330" y="190" font-family="monospace" font-size="11" fill="#ff6b35">→ ChaCha20 detecté</text>
  </g>
  
  <!-- Phase 3: Analyse Dynamique -->
  <g id="phase3">
    <rect x="590" y="80" width="160" height="120" rx="10" fill="#2d3436" stroke="url(#greenGrad)" stroke-width="2"/>
    <text x="670" y="105" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="url(#greenGrad)">Phase 3</text>
    <text x="670" y="125" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="white">Analyse Dynamique</text>
    
    <text x="600" y="145" font-family="monospace" font-size="11" fill="#ddd">• gdb ./crypt</text>
    <text x="600" y="160" font-family="monospace" font-size="11" fill="#ddd">• break chacha20_init</text>
    <text x="600" y="175" font-family="monospace" font-size="11" fill="#ddd">• x/32c $rsi</text>
    <text x="600" y="190" font-family="monospace" font-size="11" fill="#00ff88">→ Clé extraite</text>
  </g>
  
  <!-- Flèches entre phases -->
  <line x1="210" y1="140" x2="320" y2="140" stroke="url(#greenGrad)" stroke-width="3" marker-end="url(#arrowhead)"/>
  <line x1="480" y1="140" x2="590" y2="140" stroke="url(#greenGrad)" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Données extraites -->
  <g id="extracted-data">
    <rect x="200" y="250" width="400" height="150" rx="15" fill="#636e72" stroke="url(#greenGrad)" stroke-width="2"/>
    <text x="400" y="280" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Données Extraites</text>
    
    <!-- Clé -->
    <text x="220" y="310" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="url(#greenGrad)">Clé (32 bytes):</text>
    <rect x="220" y="315" width="360" height="25" rx="5" fill="#2d3436" stroke="#555"/>
    <text x="225" y="332" font-family="monospace" font-size="12" fill="#00ff88">BRAAAAAAAAAAAAAAAAAAAAAAAAAINS!!</text>
    
    <!-- Nonce -->
    <text x="220" y="360" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="url(#greenGrad)">Nonce (12 bytes):</text>
    <rect x="220" y="365" width="200" height="25" rx="5" fill="#2d3436" stroke="#555"/>
    <text x="225" y="382" font-family="monospace" font-size="12" fill="#74b9ff">00 00 00 00 00 00 00 00 00 00 00 00</text>
  </g>
  
  <!-- Phase 4: Développement -->
  <g id="phase4">
    <rect x="50" y="450" width="200" height="100" rx="10" fill="#2d3436" stroke="url(#blueGrad)" stroke-width="2"/>
    <text x="150" y="475" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="url(#blueGrad)">Phase 4</text>
    <text x="150" y="495" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="white">Développement</text>
    
    <text x="60" y="515" font-family="monospace" font-size="11" fill="#ddd">• Déchiffreur Python</text>
    <text x="60" y="530" font-family="monospace" font-size="11" fill="#ddd">• ChaCha20.new()</text>
    <text x="60" y="545" font-family="monospace" font-size="11" fill="#74b9ff">→ Flag récupéré</text>
  </g>
  
  <!-- Phase 5: Validation -->
  <g id="phase5">
    <rect x="550" y="450" width="200" height="100" rx="10" fill="#2d3436" stroke="url(#orangeGrad)" stroke-width="2"/>
    <text x="650" y="475" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="url(#orangeGrad)">Phase 5</text>
    <text x="650" y="495" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="white">Analyse Vulnérabilités</text>
    
    <text x="560" y="515" font-family="monospace" font-size="11" fill="#ddd">• Clé hardcodée</text>
    <text x="560" y="530" font-family="monospace" font-size="11" fill="#ddd">• Nonce réutilisé</text>
    <text x="560" y="545" font-family="monospace" font-size="11" fill="#ff6b35">→ Vulnérabilités</text>
  </g>
  
  <!-- Flag final -->
  <rect x="300" y="470" width="200" height="60" rx="10" fill="#00b894" stroke="url(#greenGrad)" stroke-width="2"/>
  <text x="400" y="490" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">FLAG OBTENU</text>
  <text x="400" y="510" font-family="monospace" font-size="12" text-anchor="middle" fill="white">HTB{und01ng_th3_</text>
  <text x="400" y="525" font-family="monospace" font-size="12" text-anchor="middle" fill="white">curs3_0f_und34th}</text>
  
  <!-- Flèches vers le flag -->
  <line x1="150" y1="450" x2="300" y2="500" stroke="url(#greenGrad)" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="400" x2="400" y2="470" stroke="url(#greenGrad)" stroke-width="3" marker-end="url(#arrowhead)"/>
  <line x1="650" y1="450" x2="500" y2="500" stroke="url(#greenGrad)" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Outils utilisés -->
  <g id="tools">
    <text x="70" y="580" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="url(#greenGrad)">Outils:</text>
    <text x="130" y="580" font-family="monospace" font-size="11" fill="#ddd">objdump • strings • GDB • Python • ChaCha20</text>
  </g>
</svg>
